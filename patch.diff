--- a/internal/ydb/client.go
+++ b/internal/ydb/client.go
@@ -1581,12 +1581,19 @@ func (c *YDBClient) GetVideoByShareToken(ctx context.Context, token string) (*V
 
 // SearchVideos ищет видео с пагинацией
 func (c *YDBClient) SearchVideos(ctx context.Context, orgID, userID, query string, limit, offset int) ([]*Video, int64, error) {
-	baseQuery := `FROM videos WHERE org_id = $org_id AND is_deleted = false`
-	args := []types.Value{
-		types.TextValue(orgID),
-	}
+	// Объявляем переменные для запроса
+	var countQuery, dataQuery string
+	var countParams, dataParams *table.QueryParameters
+	
+	// Базовая часть WHERE clause
+	whereClause := `WHERE org_id = $org_id AND is_deleted = false`
 
+	// Добавляем фильтр по пользователю если указан
 	if userID != "" {
-		baseQuery += ` AND uploaded_by = $user_id`
-		args = append(args, types.TextValue(userID))
+		whereClause += ` AND uploaded_by = $user_id`
 	}
 
+	// Добавляем фильтр по поисковому запросу если указан
 	if query != "" {
-		baseQuery += ` AND file_name_search LIKE $query`
-		args = append(args, types.TextValue("%"+strings.ToLower(query)+"%"))
+		whereClause += ` AND file_name_search LIKE $query`
 	}
 
-	// Count total
-	countQuery := `SELECT COUNT(*) ` + baseQuery
+	// Формируем запрос для подсчета
+	countQuery = `
+		DECLARE $org_id AS Text;
+		DECLARE $user_id AS Optional<Text>;
+		DECLARE $query AS Optional<Utf8>;
+		
+		SELECT COUNT(*) FROM videos ` + whereClause
+	
+	// Параметры для подсчета
+	countParamsBuilder := []table.ParameterOption{
+		table.ValueParam("$org_id", types.TextValue(orgID)),
+	}
+	
+	if userID != "" {
+		countParamsBuilder = append(countParamsBuilder, table.ValueParam("$user_id", types.OptionalValue(types.TextValue(userID))))
+	} else {
+		countParamsBuilder = append(countParamsBuilder, table.ValueParam("$user_id", types.NullValue(types.TypeText)))
+	}
+	
+	if query != "" {
+		countParamsBuilder = append(countParamsBuilder, table.ValueParam("$query", types.OptionalValue(types.UTF8Value("%"+strings.ToLower(query)+"%"))))
+	} else {
+		countParamsBuilder = append(countParamsBuilder, table.ValueParam("$query", types.NullValue(types.TypeUTF8)))
+	}
+	
+	countParams = table.NewQueryParameters(countParamsBuilder...)
+	
 	var total uint64
 
 	err := c.driver.Table().Do(ctx, func(ctx context.Context, session table.Session) error {
-		_, res, err := session.Execute(ctx, table.DefaultTxControl(), countQuery,
-			table.NewQueryParameters(
-				table.ValueParam("$org_id", args[0]),
-				func() table.ParameterOption {
-					if len(args) > 1 {
-						return table.ValueParam("$user_id", args[1])
-					}
-					return table.ValueParam("$user_id", types.NullValue(types.TypeText))
-				}(),
-				func() table.ParameterOption {
-					if len(args) > 2 {
-						return table.ValueParam("$query", types.OptionalValue(args[2]))
-					}
-					return table.ValueParam("$query", types.NullValue(types.TypeUTF8))
-				}(),
-			),
-		)
+		_, res, err := session.Execute(ctx, table.DefaultTxControl(), countQuery, countParams)
 		if err != nil {
 			return err
 		}
@@ -1631,18 +1638,38 @@ func (c *YDBClient) SearchVideos(ctx context.Context, orgID, userID, query stri
 		return 0, err
 	}
 
-	// Get data
-	dataQuery := `SELECT video_id, org_id, uploaded_by, file_name, file_name_search, file_size_bytes, storage_path, duration_seconds, upload_id, upload_status, parts_uploaded, total_parts, public_share_token, share_expires_at, uploaded_at, created_at, is_deleted ` + baseQuery + ` ORDER BY uploaded_at DESC LIMIT $limit OFFSET $offset`
-	args = append(args, types.Uint64Value(uint64(limit)), types.Uint64Value(uint64(offset)))
+	// Формируем запрос для получения данных
+	dataQuery = `
+		DECLARE $org_id AS Text;
+		DECLARE $user_id AS Optional<Text>;
+		DECLARE $query AS Optional<Utf8>;
+		DECLARE $limit AS Uint64;
+		DECLARE $offset AS Uint64;
+		
+		SELECT video_id, org_id, uploaded_by, file_name, file_name_search, file_size_bytes, 
+		       storage_path, duration_seconds, upload_id, upload_status, parts_uploaded, total_parts, 
+		       public_share_token, share_expires_at, uploaded_at, created_at, is_deleted
+		FROM videos ` + whereClause + `
+		ORDER BY uploaded_at DESC 
+		LIMIT $limit OFFSET $offset`
+	
+	// Параметры для получения данных
+	dataParamsBuilder := []table.ParameterOption{
+		table.ValueParam("$org_id", types.TextValue(orgID)),
+	}
+	
+	if userID != "" {
+		dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$user_id", types.OptionalValue(types.TextValue(userID))))
+	} else {
+		dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$user_id", types.NullValue(types.TypeText)))
+	}
+	
+	if query != "" {
+		dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$query", types.OptionalValue(types.UTF8Value("%"+strings.ToLower(query)+"%"))))
+	} else {
+		dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$query", types.NullValue(types.TypeUTF8)))
+	}
+	
+	dataParamsBuilder = append(dataParamsBuilder, 
+		table.ValueParam("$limit", types.Uint64Value(uint64(limit))),
+		table.ValueParam("$offset", types.Uint64Value(uint64(offset))),
+	)
+	
+	dataParams = table.NewQueryParameters(dataParamsBuilder...)
 
 	var videos []*Video
 
 	err = c.driver.Table().Do(ctx, func(ctx context.Context, session table.Session) error {
-		_, res, err := session.Execute(ctx, table.DefaultTxControl(), dataQuery,
-			table.NewQueryParameters(
-				table.ValueParam("$org_id", args[0]),
-				func() table.ParameterOption {
-					if len(args) > 1 {
-						return table.ValueParam("$user_id", args[1])
-					}
-					return table.ValueParam("$user_id", types.NullValue(types.TypeText))
-				}(),
-				func() table.ParameterOption {
-					if len(args) > 2 {
-						return table.ValueParam("$query", types.OptionalValue(args[2]))
-					}
-					return table.ValueParam("$query", types.NullValue(types.TypeUTF8))
-				}(),
-				table.ValueParam("$limit", args[len(args)-2]),
-				table.ValueParam("$offset", args[len(args)-1]),
-			),
-		)
+		_, res, err := session.Execute(ctx, table.DefaultTxControl(), dataQuery, dataParams)
 		if err != nil {
 			return err
 		}
