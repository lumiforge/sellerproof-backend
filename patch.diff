@@ func (c *YDBClient) SearchVideos(ctx context.Context, orgID, userID, query string, limit, offset int) ([]*Video, int64, error) {
-    // Базовая часть WHERE clause
-    whereClause := `WHERE org_id = $org_id AND is_deleted = false`
-    // Добавляем фильтр по пользователю если указан
-
-    if userID != "" {
-        whereClause += ` AND uploaded_by = $user_id`
-    }
-
-    if query != "" {
-        whereClause += ` AND file_name_search LIKE $query`
-    }
+    whereClause := `WHERE org_id = $org_id AND is_deleted = false`
+    whereClause += ` AND ($user_id IS NULL OR uploaded_by = $user_id)`
+    if query != "" {
+        whereClause += ` AND file_name_search LIKE $query`
+    }
@@
-    countQuery = `
-    DECLARE $org_id AS Text;
-    DECLARE $user_id AS Optional<Text>;
-    DECLARE $query AS Optional<Utf8>;
-
-    SELECT COUNT(*) FROM videos ` + whereClause
+    countQuery = `
+    DECLARE $org_id AS Text;
+    DECLARE $user_id AS Optional<Text>;
+    DECLARE $query AS Optional<Utf8>;
+    SELECT COUNT(*) FROM videos ` + whereClause
@@
-    countParamsBuilder := []table.ParameterOption{
-        table.ValueParam("$org_id", types.TextValue(orgID)),
-    }
-
-    if userID != "" {
-        countParamsBuilder = append(countParamsBuilder, table.ValueParam("$user_id", types.OptionalValue(types.TextValue(userID))))
-    } else {
-        countParamsBuilder = append(countParamsBuilder, table.ValueParam("$user_id", types.NullValue(types.TypeText)))
-    }
+    countParamsBuilder := []table.ParameterOption{
+        table.ValueParam("$org_id", types.TextValue(orgID)),
+        table.ValueParam("$user_id", types.OptionalValue(types.TextValue(userID))),
+    }
@@
-    if query != "" {
-        countParamsBuilder = append(countParamsBuilder, table.ValueParam("$query", types.OptionalValue(types.UTF8Value("%"+strings.ToLower(query)+"%"))))
-    } else {
-        countParamsBuilder = append(countParamsBuilder, table.ValueParam("$query", types.NullValue(types.TypeUTF8)))
-    }
+    if query != "" {
+        countParamsBuilder = append(countParamsBuilder, table.ValueParam("$query", types.OptionalValue(types.UTF8Value("%"+strings.ToLower(query)+"%"))))
+    } else {
+        countParamsBuilder = append(countParamsBuilder, table.ValueParam("$query", types.NullValue(types.TypeUTF8)))
+    }
@@
-    dataQuery = `
-    DECLARE $org_id AS Text;
-    DECLARE $user_id AS Optional<Text>;
-    DECLARE $query AS Optional<Utf8>;
-    DECLARE $limit AS Uint64;
-    DECLARE $offset AS Uint64;
-
-    SELECT video_id, org_id, uploaded_by, file_name, file_name_search, file_size_bytes, 
-           storage_path, duration_seconds, upload_id, upload_status, parts_uploaded, total_parts, 
-           public_share_token, share_expires_at, uploaded_at, created_at, is_deleted
-    FROM videos ` + whereClause + `
-    ORDER BY uploaded_at DESC 
-    LIMIT $limit OFFSET $offset`
+    dataQuery = `
+    DECLARE $org_id AS Text;
+    DECLARE $user_id AS Optional<Text>;
+    DECLARE $query AS Optional<Utf8>;
+    DECLARE $limit AS Uint64;
+    DECLARE $offset AS Uint64;
+    SELECT video_id, org_id, uploaded_by, file_name, file_name_search, file_size_bytes, 
+           storage_path, duration_seconds, upload_id, upload_status, parts_uploaded, total_parts, 
+           public_share_token, share_expires_at, uploaded_at, created_at, is_deleted
+    FROM videos ` + whereClause + `
+    ORDER BY uploaded_at DESC 
+    LIMIT $limit OFFSET $offset`
@@
-    dataParamsBuilder := []table.ParameterOption{
-        table.ValueParam("$org_id", types.TextValue(orgID)),
-    }
-
-    if userID != "" {
-        dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$user_id", types.OptionalValue(types.TextValue(userID))))
-    } else {
-        dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$user_id", types.NullValue(types.TypeText)))
-    }
+    dataParamsBuilder := []table.ParameterOption{
+        table.ValueParam("$org_id", types.TextValue(orgID)),
+        table.ValueParam("$user_id", types.OptionalValue(types.TextValue(userID))),
+    }
@@
-    if query != "" {
-        dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$query", types.OptionalValue(types.UTF8Value("%"+strings.ToLower(query)+"%"))))
-    } else {
-        dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$query", types.NullValue(types.TypeUTF8)))
-    }
+    if query != "" {
+        dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$query", types.OptionalValue(types.UTF8Value("%"+strings.ToLower(query)+"%"))))
+    } else {
+        dataParamsBuilder = append(dataParamsBuilder, table.ValueParam("$query", types.NullValue(types.TypeUTF8)))
+    }
@@
-    dataParamsBuilder = append(dataParamsBuilder,
-        table.ValueParam("$limit", types.Uint64Value(uint64(limit))),
-        table.ValueParam("$offset", types.Uint64Value(uint64(offset))),
-    )
+    dataParamsBuilder = append(dataParamsBuilder,
+        table.ValueParam("$limit", types.Uint64Value(uint64(limit))),
+        table.ValueParam("$offset", types.Uint64Value(uint64(offset))),
+    )
