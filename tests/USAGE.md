# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –≤–∞—à–∏–º URL:**
   ```bash
   export SERVICE_URL="https://–≤–∞—à-—Ä–µ–∞–ª—å–Ω—ã–π-url.apigw.yandexcloud.net"
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã:**
   ```bash
   cd tests
   make test
   ```

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç

–¢–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞—à–µ–≥–æ REST API —Å–µ—Ä–≤–∏—Å–∞:

### AuthService (–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
- üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`POST /api/v1/auth/register`)
- üîê –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`POST /api/v1/auth/login`)
- üë§ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (`GET /api/v1/auth/profile`)
- ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (`PUT /api/v1/auth/profile`)
- üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- üö™ –í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### VideoService (–í–∏–¥–µ–æ)
- üìπ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ (`POST /api/v1/video/upload/initiate`)
- üîó –ü–æ–ª—É—á–µ–Ω–∏–µ URL –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Å—Ç–µ–π (`POST /api/v1/video/upload/urls`)
- ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ (`POST /api/v1/video/upload/complete`)
- üìπ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∏–¥–µ–æ (`GET /api/v1/video`)
- üîç –ü–æ–∏—Å–∫ –≤–∏–¥–µ–æ (`GET /api/v1/video/search`)
- üîó –°–æ–∑–¥–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Å—ã–ª–∫–∏ (`POST /api/v1/video/share`)
- üåç –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –≤–∏–¥–µ–æ (`GET /api/v1/video/public`)
- üö´ –û—Ç–∑—ã–≤ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Å—ã–ª–∫–∏ (`POST /api/v1/video/share/revoke`)

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# URL –≤–∞—à–µ–≥–æ API Gateway (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
export SERVICE_URL="https://–≤–∞—à-url.apigw.yandexcloud.net"

# –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
export TIMEOUT="30"

# –†–µ–∂–∏–º —Ç–µ—Å—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
export TEST_MODE="auth"    # –¢–æ–ª—å–∫–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
export TEST_MODE="video"   # –¢–æ–ª—å–∫–æ –≤–∏–¥–µ–æ
export TEST_MODE=""       # –í—Å–µ —Ç–µ—Å—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```

## üõ†Ô∏è –°–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞

### –°–ø–æ—Å–æ–± 1: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
export SERVICE_URL="https://–≤–∞—à-url.apigw.yandexcloud.net"
cd tests && make test
```

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ Makefile
```bash
cd tests && make build SERVICE_URL="https://–≤–∞—à-url.apigw.yandexcloud.net"
make run
```

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
```bash
cd tests && ./run_tests.sh -u "https://–≤–∞—à-url.apigw.yandexcloud.net"
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤

–ö–ª–∏–µ–Ω—Ç –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —ç–º–æ–¥–∑–∏:
- ‚úÖ **–£–°–ü–ï–•** - –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω
- ‚ùå **–û–®–ò–ë–ö–ê** - –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π

## üîç –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### "API Gateway not found by host name"
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π URL API Gateway
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å URL –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `SERVICE_URL`

### "PermissionDenied" –∏–ª–∏ "403 Forbidden"
**–ü—Ä–∏—á–∏–Ω–∞:** –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ —ç—Ç–æ –Ω–µ REST API —Å–µ—Ä–≤–∏—Å
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ REST API Gateway

### "connection timeout"
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é –∏–ª–∏ —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞

### "request failed with status 404"
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å API –∏–ª–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

## üêõ –û—Ç–ª–∞–¥–∫–∞

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
make debug
```

–≠—Ç–æ –≤–∫–ª—é—á–∏—Ç –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤.

## üìù –ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

```bash
$ export TEST_URL="https://my-service.apigw.yandexcloud.net"
$ cd tests && make test

üßπ –û—á–∏—Å—Ç–∫–∞...
rm -f test-client
‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
üî® –°–±–æ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞...
go build -ldflags "-X main.serviceURL=https://my-service.apigw.yandexcloud.net" -o test-client ./cmd/test-client
chmod +x test-client
‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è SellerProof Backend
üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–∏—Å—É: https://my-service.apigw.yandexcloud.net
./test-client
üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è SellerProof Backend
üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–∏—Å—É: https://my-service.apigw.yandexcloud.net
üîó –ê–¥—Ä–µ—Å –¥–ª—è gRPC: my-service.apigw.yandexcloud.net:443
‚è±Ô∏è  –¢–∞–π–º–∞—É—Ç: 30 —Å–µ–∫—É–Ω–¥
üéØ –†–µ–∂–∏–º: –≤—Å–µ —Ç–µ—Å—Ç—ã

üîê –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏...
üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...
[‚úÖ –£–°–ü–ï–•] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
   ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: user123, —Å–æ–æ–±—â–µ–Ω–∏–µ: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω

...

‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!